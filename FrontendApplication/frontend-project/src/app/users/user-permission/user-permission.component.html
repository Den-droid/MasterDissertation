<div class="main-content">
    <div class="card p-4 shadow-sm">
        <h2 class="text-center mb-4">
            {{title}}
        </h2>

        <form [formGroup]="form">
            <div class="row g-1">
                <div class="col-md-3 p-1">
                    <h5 class="mb-2">Виберіть університети:</h5>
                    <input class="form-control mb-2" placeholder="Пошук..." formControlName="universitySearch" />
                    <div class="list-group" style="max-height:40vh; overflow:auto;">
                        @for(university of filteredUniversities; track university.id){
                        <label class="list-group-item d-flex align-items-center">
                            <input class="form-check-input me-2" type="checkbox"
                                [checked]="isUniversitySelected(university.id)"
                                (change)="toggleUniversity(university.id)" />
                            <span>{{ university.name }}</span>
                        </label>
                        }
                    </div>
                </div>
                <div class="col-md-3 p-1">
                    <h5 class="mb-2">Виберіть предмети:</h5>
                    <input class="form-control mb-2" placeholder="Пошук..." formControlName="subjectSearch" />
                    <div class="list-group" style="max-height:40vh; overflow:auto;">
                        @for(subject of filteredSubjects; track subject.id){
                        <label class="list-group-item d-flex align-items-center">
                            <input class="form-check-input me-2" type="checkbox"
                                [checked]="isSubjectSelected(subject.id)" (change)="toggleSubject(subject.id)" />
                            <span>{{ subject.name }}</span>
                        </label>
                        }
                    </div>
                    <label>
                        <input type="checkbox" formControlName="includeSubjects">
                        {{includeSubjectText}}
                    </label>
                </div>
                <div class="col-md-3 p-1">
                    <h5 class="mb-2">Виберіть функції:</h5>
                    <input class="form-control mb-2" placeholder="Пошук..." formControlName="functionSearch" />
                    <div class="list-group" style="max-height:40vh; overflow:auto;">
                        @for(function of filteredFunctions; track function.id){
                        <label class="list-group-item d-flex align-items-center">
                            <input class="form-check-input me-2" type="checkbox"
                                [checked]="isFunctionSelected(function.id)" (change)="toggleFunction(function.id)" />
                            <span>{{ function.text }}</span>
                        </label>
                        }
                    </div>
                    <label>
                        <input type="checkbox" formControlName="includeFunctions">
                        {{includeFunctionText}}
                    </label>
                </div>
                <div class="col-md-3 p-1">
                    <h5 class="mb-2">Виберіть завдання:</h5>
                    <input class="form-control mb-2" placeholder="Пошук..." formControlName="assignmentSearch" />
                    <div class="list-group" style="max-height:40vh; overflow:auto;">
                        @for(assignment of filteredAssignments; track assignment.id){
                        <label class="list-group-item d-flex align-items-center">
                            <input class="form-check-input me-2" type="checkbox"
                                [checked]="isAssignmentSelected(assignment.id)"
                                (change)="toggleAssignment(assignment.id)" />
                            <span>{{ getStudentFullName(assignment.user) }}</span>
                        </label>
                        }
                    </div>
                </div>
            </div>

            @if(saveButtonClicked && nothingSelected()){
            <div class="alert alert-danger mt-2">
                {{atLeastOneMessage}}
            </div>
            }

            @if(showError){
            <div class="alert alert-danger mt-2">
                {{errorMessage}}
            </div>
            }

            <div class="d-flex justify-content-between mt-4">
                <button type="button" class="btn btn-secondary" (click)="goBack()">
                    <i class="fa-solid fa-arrow-left me-1"></i> Назад
                </button>

                <button type="button" class="btn btn-primary" (click)="save()">
                    Зберегти
                </button>
            </div>
        </form>
    </div>
</div>